<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Page Needs
  ================================================== -->
	<meta charset="utf-8">
	<title>Documentation of PgnViewerJS</title>
	<meta name="description" content="Shows the documentation that could be used to include PgnViewerJS in your web site.">
	<meta name="author" content="Markus Liebelt">

	<!-- Mobile Specific Metas
  ================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
  ================================================== -->
	<link rel="stylesheet" href="css/base.css">
	<link rel="stylesheet" href="css/skeleton.css">
	<link rel="stylesheet" href="css/layout.css">

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Favicons
	================================================== -->
    <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

</head>
<body>



	<!-- Primary Page Layout
	================================================== -->

	<!-- Delete everything in this .container and get started on your own site! -->

	<div class="container">
		<div class="sixteen columns">
			<h1 class="remove-bottom" style="margin-top: 40px">PgnViewerJS</h1>
			<h5>Version 0.9.0</h5>
			<hr />
		</div>
        <div class="container">
            <div class="two columns">
                <h1>ML</h1>
            </div>

            <div id="nav" class="fourteen columns">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="docu.html">Documentation</a></li>
                    <li><a href="examples.html">Examples</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
        </div><!-- container -->
		<div class="sixteen columns">
		<h1 id="plan-for-pgnviewerjs">Plan for PgnViewerJS</h1>
<p>The following describes  what is planed for the viewer. This is more concrete than <code>readme.md</code>, but
there is of course no guarantee that anything will be implemented soon.</p>
<h2 id="planed-features">Planed features</h2>
<ul>
<li>Allows to show one or more chess games complete</li>
<li>Allow to play through the games forward and backward, including variations.</li>
<li>Allows to play from a legal position legal moves, and adds these moves to the notation (in a different style)</li>
<li>Allows to play through<ul>
<li>clicking on moves</li>
<li>clicking on next and previous button</li>
<li>clicking on play button</li>
</ul>
</li>
</ul>
<h2 id="planed-and-working">Planed and working</h2>
<h3 id="visual">Visual</h3>
<h4 id="add-additional-figure-sets-">Add additional figure sets (/)</h4>
<ul>
<li>Add as figure sets the ones from chess.com and from ChessTempo Merida.</li>
<li>Added as well case, condal, leipzig and maya from ChessTempo.</li>
</ul>
<h5 id="additional-figures-working-">Additional figures (working)</h5>
<ul>
<li>Allow others to add figure sets as well.</li>
<li>Provide a registry, and provide there an additional path to the set (relative to the
JavaScript file that loads it).</li>
<li>Organisation has to be the same:<ul>
<li>Path to the piece style (only variant here).</li>
<li>Directory named as the piece style.</li>
<li>Then &#39;/{piece}.png&#39;</li>
</ul>
</li>
</ul>
<h4 id="generate-from-pgn-structure-moves-working-">Generate from PGN structure moves (working)</h4>
<ul>
<li>Generate a reasonable frame for the moves (id: <ID>Moves, class: moves).</li>
<li>Generate the moves in a pleasant style.</li>
<li>Look at different books and try to adapt some of the styles, allow the style to be set
(as attribute moveStyle).</li>
</ul>
<h4 id="generate-pgn-move-from-data">Generate PGN move from data</h4>
<ul>
<li>We have to know every detail from moves, so the resulting notation is not sufficient.</li>
<li>Collect the details during parsing, and give them out (additionally) so that it can
be used when generating move output.</li>
<li>What support is available from chess.js? The following should be clarified:<ul>
<li>Disambiguation: is that necessary or not? Examples: Nd7, Ng8, move Nf6 is not clear.
But when white pins the black Nd7, then Nf6 does not need disambiguation.</li>
</ul>
</li>
</ul>
<h4 id="different-move-styles-working-">Different move styles (working)</h4>
<ul>
<li>one or two column (depending on how much to show)</li>
<li>Main moves flowing or one move (white and black) on one line.</li>
<li>References to the diagrams (numbered, who is to move)</li>
<li>Variations flowing in block mode (normally)</li>
<li>Use Figurine instead of the move letters (for white and black with the same symbols)</li>
<li>white and black together (without comment) as block, if more than one block fits on one line,
make two or more blocks.</li>
</ul>
<h4 id="different-pgn-header-display-working-">Different PGN header display (working)</h4>
<ul>
<li>None at all (default?)</li>
<li>White and Black players bold, rest flowing (order?)</li>
<li>Normal order is<ul>
<li>Wikipedia definition<ul>
<li>Mandatory: Event, Site, Date, Round, White, Black, Result.</li>
<li>Optional: Annotator, PlyCount, TimeControl, Time, Termination, Mode, ...</li>
</ul>
</li>
<li>New in Chess: Event, Notes by <Annotator>, White, Black, Event, Date</li>
<li>Sicilian Love: White, Black, Round, Site, Year</li>
</ul>
</li>
</ul>
<h4 id="prepare-different-layouts-for-headers-working-">Prepare different layouts for headers (working)</h4>
<ul>
<li>See the example with Chess.com</li>
<li>Try to find different examples, and build them in plain HTML (including CSS)</li>
<li>Use that CSS later for different styles<ul>
<li>Styles for the board itself</li>
<li>Styles for the display of the moves and comments</li>
<li>Styles for the display of the headers</li>
</ul>
</li>
<li>Generate all HTML elements, so that they can be included easily. Works well
for the board and the moves, will work for the headers additionally.</li>
</ul>
<h4 id="allow-additional-boards">Allow additional boards</h4>
<ul>
<li>Use a special comment for that (like {diagram})</li>
<li>The generation should be the same as the main board (with the same configuration)
but reduced size of course.</li>
<li>Play with different layout possibilities:<ul>
<li>Centered, moves then below</li>
<li>Left, moves flowing to the right</li>
<li>Other ??</li>
</ul>
</li>
</ul>
<h4 id="understand-fen-in-a-better-way">Understand FEN in a better way</h4>
<p>Currently, FEN is black magic. I have to understand what is inside a FEN string, and construct
from that some more information that may be needed otherwise. The following information
is taken by <code>chess.js</code>:</p>
<ul>
<li>All rows of the chess board with the white and black pieces on it</li>
<li>6 space delimited fields: castling, en-passent, side to move, # half moves, # moves, ...</li>
</ul>
<p>But not all of this information is available from the outside. So it is difficult to get
the current move number, ...</p>
<h4 id="pgn-annotations-working-">PGN Annotations (working)</h4>
<ul>
<li>See <a href="http://en.wikipedia.org/wiki/Numeric_Annotation_Glyphs">http://en.wikipedia.org/wiki/Numeric_Annotation_Glyphs</a> (NAGs) for the meaning</li>
<li>how to represent them as symbols?</li>
<li>Is there a font for the special symbols, or are these available everywhere?</li>
</ul>
<h4 id="provide-a-fen-api-that-can-be-used-from-the-outside-">Provide a FEN API that can be used from the outside.</h4>
<p>At least move number, turn, en-passent, rochade, ... should be possible.</p>
<h4 id="generate-pgn-including-comments-and-variations-working-">Generate PGN including comments and variations (working)</h4>
<ul>
<li>Decide the structure of all moves (div, span, IDs, classes, hierarchy).</li>
<li>Use the linked moves in generation.</li>
<li>Allow different styling by CSS only (for the <code>&lt;div class=&quot;moves&quot;&gt;...&lt;/div&gt;</code>)</li>
<li>Provide examples for<ul>
<li>main line in one column</li>
<li>main line in one paragraph</li>
<li>variations inlined</li>
<li>variations separated by paragraphs</li>
<li>different styling for them</li>
</ul>
</li>
</ul>
<h3 id="infrastructure">Infrastructure</h3>
<h4 id="structure-of-the-project-working-">Structure of the project (working)</h4>
<ul>
<li>Get rid of the sub-modules. This was initially a good idea, but is not well now.</li>
<li>Use instead<ul>
<li>separate folders during development, so it is easier to develop (and replace older versions
by newer ones)</li>
<li>Rules in the Gruntfile which files should be selected for the distribution (in which order) </li>
</ul>
</li>
</ul>
<p>The real structure as distribution should be the following:</p>
<p>/ root of the files
  readme.md
  /js
    /pgnviewerjs.js (minified version)
  /css
    chessboard.css (original file, no change)
    pgnvjs.css (rules for PgnViewerJS only, changes to chessboard.css separated from the rest)
  /img
    /buttons (for theming the additional buttons)
      /ff (buttons of ?? SEARCH FOR SOURCE)
      /tango (buttons of tango item theme SEARCH FOR SOURCE) <a href="http://tango.freedesktop.org/releases/tango-icon-theme-0.8.90.tar.gz">http://tango.freedesktop.org/releases/tango-icon-theme-0.8.90.tar.gz</a>
    /chesspieces
      /separate folders for each piece theme
    /pattern
      <em>.png (pattern used in file pgnvjs.css)
    blackwhite-</em> (button for flipping sided --&gt; should be moved to buttons)
  /locales
    chess-<em>.json (names of the chess pieces, defaults not necesary)
    nag-</em>.json (meanings of NAG (<a href="http://en.wikipedia.org/wiki/Numeric_Annotation_Glyphs">http://en.wikipedia.org/wiki/Numeric_Annotation_Glyphs</a>), not used at the moment. Should be rendered when used in the PGN notation (e.g. by output of ChessBase))</p>
<h4 id="building-distribution-working-">Building distribution  (working)</h4>
<ul>
<li>Use Grunt for building a distribution (/)</li>
<li>Extract only the files that are needed.</li>
<li>Decide which ones of them should be used in which version.</li>
<li>Decide which ones should be minified (all?) and / or concatenated</li>
<li>Decide if more than one distribution is needed<ul>
<li>With minimal figure sets (merida, wikipedia?)</li>
<li>What else?</li>
</ul>
</li>
<li>Let the structure as is, see if configuration for paths is needed (if someone
wants to deploy on different paths).</li>
</ul>
<h4 id="structure-distribution">Structure distribution</h4>
<ul>
<li>What should be the structure of a distributed application? I had problems (first) in using the gruntified application ...</li>
<li>Does it make sense to have different ones: small, typical, full?</li>
<li>What should be the different parts in it?</li>
</ul>
<h4 id="distribution-and-github">Distribution and GitHub</h4>
<ul>
<li>What are normal patterns for distributions on GitHub?</li>
<li>Which one of them is the right approach for mine?</li>
<li>What are the requirements (of myself) according to GitHub and packaging?</li>
<li>Is there a way to provide an example web site for showing how the application works in real life (without buying something)?</li>
</ul>
<h4 id="provide-web-site-for-distribution-working-">Provide web site for distribution (working)</h4>
<ul>
<li>Design a web site for this project that helps to make marketing.</li>
<li>Provide the examples / documentation / ... separated from the development.</li>
<li>Ensure that building the distribution also builds the sources of the web site.</li>
<li>Use Skeleton for the Look of that web site, but ensure that the files needed for that
are separated from the files needed for PgnViewerJS.</li>
<li>Start building the documentation as a web site, so it is easier to use it locally and distribute it.  </li>
</ul>
<h2 id="done-and-mostly-finished">Done and mostly finished</h2>
<h3 id="visual">Visual</h3>
<h4 id="show-boards-">Show boards (/)</h4>
<ul>
<li>Transport the features of chessboardjs, so that the same configuration is possible.</li>
<li>Works sufficiently now.</li>
</ul>
<h4 id="understand-css-enhance-it-">Understand CSS, enhance it. (/)</h4>
<p>Currently, the theme of the board is fixed. By adding some CSS, and allowing users
to add their own one. Describe what steps users have to do to do it well.</p>
<ul>
<li>Add a new CSS file (as copy of <code>templ.css</code>)</li>
<li>Add to it<ul>
<li>a new theme key (like in the example <code>.green</code></li>
<li>Replace that at each location.</li>
<li>Adjust what you want to adjust.</li>
</ul>
</li>
</ul>
<p>See the default <code>pgnvjs.css</code> with the themes <code>blue</code> and <code>green</code> and the example <code>sample.html</code>.</p>
<h4 id="define-useful-api-for-pgnview-">Define useful API for pgnView (/)</h4>
<p>Currently the API is only one: call the function with a unique ID (for the DIVs needed),
and the configuration with everything included: PGN, configuration parameters for chess or
chessboardjs, additional parameters for anything, ...</p>
<p>This is difficult to use and will lead in short time to a mess of code, because everything
has to fit in the configuration. </p>
<p>So try to find the needed API for clients. How will they use the viewer, and what are
therefore the APIs needed?</p>
<p>Here are some ides how to structure this:</p>
<ul>
<li>Even if it is not very functional, use JS objects (with new ...) and some core APIs for them.</li>
<li>Provide more than one functional interface, that wraps the core behavior and adds some
defaults and what to do at the beginning.<ul>
<li>pgnView: Provide a viewer for a pgn game, with some variants.</li>
<li>pgnEdit: Provide a viewer that allows to edit a game.</li>
<li>pgnBoard: Provide just a board for some position (by giving a FEN string).</li>
<li>pgnBase: Base functionality, used by all others. Decide what is here or in the others.</li>
</ul>
</li>
</ul>
<h4 id="structure-pgnviewer-js-cleaner-">Structure pgnviewer.js cleaner (/)</h4>
<p>Currently the whole thing is a hack. it is not pleasant, growing, and more variables are visible
in more places than wished. At least the following should be done:</p>
<ul>
<li>Find the parts that define the board (only)<ul>
<li>configuration needed by chessboardjs, div for it, copying the part of the configuration,
filling the defaults and dependent parameters</li>
<li>utility functions to drive the board: setting position, moving, UI elements for that, ...</li>
</ul>
</li>
<li>Define the parts for the moves (that correspond to the board<ul>
<li>DIV for the moves</li>
<li>How to structure, expand, ... the DIV</li>
</ul>
</li>
<li>Define the parts for the UI itself: What is needed for viewing, annotation, editing, ...</li>
<li>Define the reading and writing of PGN (only), how to handle it, and what is the API to
work with the PGN object.</li>
</ul>
<h3 id="pgn">PGN</h3>
<h4 id="generate-moves-from-png-main-line-">Generate moves from PNG (main line) (/)</h4>
<p>Given a PNG string with some moves do the following:</p>
<ol>
<li>Give that string to chess.js and parse it.</li>
<li>Generate for all moves the HTML.</li>
<li>In each HTML move include:<ul>
<li>a span element with additional class information: mainline, white|black, ??</li>
<li>a link that calls a javascript function</li>
<li>argument to that function is the FEN string of the resulting position</li>
</ul>
</li>
<li>Print that HTML after the board in a special container.</li>
</ol>
<p>Do all of that with a new example HTML file.</p>
<h4 id="ensure-edge-cases-of-pgn-are-handled-appropriate-">Ensure edge-cases of PGN are handled appropriate (/)</h4>
<p>Current edge-cases are the following:</p>
<ul>
<li>Ending with a half-move of white</li>
<li>Starting not with the initial position (headers have to include a FEN string, see below)</li>
</ul>
<p>Later (with variations):</p>
<ul>
<li>starting and / or ending with a half-move, with that different notation for the move number
then.</li>
<li>Being recursive, that means variations holds an array of pgn result then</li>
</ul>
<h4 id="pgn-comments-">PGN Comments (/)</h4>
<ul>
<li>Allows comments at all reasonable places.</li>
<li>Hold them as commentBefore and commentAfter attributes in the move objects.</li>
</ul>
<h4 id="read-pgn-including-the-comments-and-variations-">Read PGN including the comments and variations (/)</h4>
<p>Currently, chess.js is only able to read the main line in a PGN string (I tried it).
The following is needed to construct a full-blown PgnViewer:</p>
<ul>
<li>Read all lines, and bring them in an order<ul>
<li>logically (by chess terms)</li>
<li>physically (what comes first in the PGN file should be in the output first)</li>
</ul>
</li>
<li>Define a useful data structure (JSON), that allows to navigate easily PGN.</li>
<li>Define how the moves are connected:<ul>
<li>Each one with its previous and following (logically or by ID, or in the data structure).</li>
<li>Each moves knows its variants.</li>
<li>The structure has to be hierarchical</li>
</ul>
</li>
<li>Information in the PGN are<ul>
<li>Header (see <code>chess.js</code>  for more information)</li>
<li>Moves (partly with move number or without)</li>
<li>Comments (before or after moves)</li>
<li>Special symbols, that denote something in chess notation</li>
</ul>
</li>
</ul>
<p>Is there a specification available, is that spec available offline, to study it?</p>
<h4 id="iterate-over-all-moves-including-variations-in-the-right-order-">Iterate over all moves including variations in the right order (/)</h4>
<ul>
<li>Create an iterator that can be used in the generation of the moves.</li>
<li>Each move should know its counter / index when asked.</li>
<li>Cache all moves (main line and variations) in the same cache. The index
is the index of this cache (only). The function getMove(index) should
work on this cache.</li>
<li>The index is the same that is used as key in the span / div for the move.
This index should be varied by:<ul>
<li><game-id>move<index></li>
<li>When locating an element in the page, the game-id should be taken into
consideration.</li>
</ul>
</li>
<li>Call a function with the following arguments:<ul>
<li>Current move, last move, current index, last index, </li>
</ul>
</li>
</ul>
<h4 id="bind-keys-">Bind keys (/)</h4>
<ul>
<li>Allow to stear a game by function keys.</li>
<li>If more than one game is displayed, only the game that has focus (the user has clicked in)
can be driven by the function keys.</li>
<li>Use the following function keys:<ul>
<li>&quot;left&quot;: prevMove</li>
<li>&quot;right&quot;: nextMove</li>
<li>&quot;space&quot;: </li>
</ul>
</li>
</ul>

		</div>

	</div><!-- container -->


<!-- End Document
================================================== -->
</body>
</html>